<?php

namespace Database\Factories;

use Faker\Factory as Faker;

class ReportDataFactory
{
    private static function getDisciplineList(): array
    {
        return [
            'Математика', 'Физика', 'Химия', 'Биология', 'История России', 'Всеобщая история',
            'География', 'Литература', 'Русский язык', 'Английский язык', 'Немецкий язык',
            'Французский язык', 'Экономика', 'Информатика', 'Программирование', 'Философия',
            'Искусство', 'Музыка', 'Физическая культура', 'Социология', 'Психология',
            'Политология', 'Право', 'Гражданское право', 'Уголовное право', 'Административное право',
            'Бизнес-планирование', 'Статистика', 'Экология', 'Геология', 'Астрономия',
            'Инженерная графика', 'Медицина', 'Анатомия', 'Физиология', 'Архитектура',
            'Лингвистика', 'Антропология', 'Драматургия', 'Теория вероятностей', 'Линейная алгебра',
            'Дифференциальные уравнения', 'Механика', 'Электротехника', 'Теплотехника',
            'Органическая химия', 'Неорганическая химия', 'Физическая химия', 'Ботаника',
            'Зоология', 'Генетика', 'Микробиология', 'История искусств', 'Культурология',
            'Эстетика', 'Этика', 'Логика', 'Религиоведение', 'Журналистика', 'Реклама и связи с общественностью',
            'Маркетинг', 'Менеджмент', 'Управление персоналом', 'Финансы и кредит',
            'Бухгалтерский учет', 'Аудит', 'Налоги и налогообложение', 'Международные отношения',
            'Экономическая теория', 'Макроэкономика', 'Микроэкономика', 'История экономики',
            'Социальная психология', 'Педагогика', 'Методика преподавания', 'Дошкольное образование',
            'Начальное образование', 'Технология', 'Основы безопасности жизнедеятельности',
            'Физика твердого тела', 'Квантовая механика', 'Оптика', 'Атомная физика',
            'Ядерная физика', 'Астрофизика', 'Геофизика', 'Метеорология', 'Картография',
            'Геоинформатика', 'Гидрология', 'Океанология', 'Ландшафтоведение', 'Почвоведение',
            'Биогеография', 'Биохимия', 'Биофизика', 'Нейробиология', 'Иммунология',
            'Фармакология', 'Патология', 'Хирургия', 'Терапия', 'Педиатрия', 'Стоматология',
            'Акушерство и гинекология', 'Эпидемиология', 'Гигиена', 'Медицинская статистика',
            'Сестринское дело', 'Физиотерапия', 'Медицинская техника', 'Радиология',
            'Онкология', 'Кардиология', 'Неврология', 'Психиатрия', 'Судебная медицина',
            'Токсикология', 'Клиническая психология', 'Психотерапия', 'Психоанализ',
            'Организационная психология', 'Психология труда', 'Социальная работа',
            'Социальная педагогика', 'Конфликтология', 'Теория коммуникации', 'Массовая коммуникация',
            'Медиалогия', 'Издательское дело', 'Редактирование', 'Литературное творчество',
            'Теория литературы', 'Сравнительное литературоведение', 'Фольклористика',
            'Языкознание', 'Семантика', 'Синтаксис', 'Фонетика', 'Морфология', 'Лексикология',
            'Стилистика', 'Диалектология', 'История языка', 'Переводоведение', 'Технический перевод',
            'Синхронный перевод', 'Литературный перевод', 'История музыки', 'Музыкальная теория',
            'Композиция', 'Дирижирование', 'Инструментоведение', 'Вокальное искусство',
            'Хореография', 'Театральное искусство', 'Режиссура', 'Актерское мастерство',
            'Сценография', 'Костюмология', 'Киноискусство', 'Киноведение', 'Операторское мастерство',
            'Монтаж', 'Звукорежиссура', 'Дизайн', 'Графический дизайн', 'Промышленный дизайн',
            'Дизайн интерьера', 'Ландшафтный дизайн', 'Мода и текстиль', 'Живопись',
            'Скульптура', 'Графика', 'Керамика', 'Реставрация', 'Архитектурное проектирование',
            'Градостроительство', 'Строительные конструкции', 'Строительные материалы',
            'Технология строительства', 'Геодезия', 'Инженерные сети', 'Автоматизация процессов',
            'Робототехника', 'Мехатроника', 'Машиностроение', 'Технология машиностроения',
            'Автомобиле- и тракторостроение', 'Судостроение', 'Авиастроение', 'Ракетостроение',
            'Металлургия', 'Материаловедение', 'Технология металлов', 'Сварочное производство',
            'Химическая технология', 'Нефтегазовое дело', 'Горное дело', 'Обогащение полезных ископаемых',
            'Маркшейдерия', 'Электроника', 'Радиотехника', 'Телекоммуникации', 'Сети связи',
            'Информационная безопасность', 'Кибербезопасность', 'Системный анализ',
            'Управление проектами', 'Логистика', 'Транспортные системы', 'Автомобильный транспорт',
            'Железнодорожный транспорт', 'Авиационный транспорт', 'Морской транспорт',
            'Технология пищевых производств', 'Биотехнология', 'Нанотехнологии', 'Энергетика',
            'Теплоэнергетика', 'Электроэнергетика', 'Возобновляемые источники энергии',
            'Ядерная энергетика', 'Энергоэффективность', 'Приборостроение', 'Оптотехника',
            'Лазерная техника', 'Космические технологии', 'Астродинамика', 'Радиофизика',
            'Геоэкология', 'Экономическая география', 'Регионоведение', 'Туризм',
            'Гостиничное дело', 'Сервис', 'Кулинарное искусство', 'Технология деревообработки',
            'Лесное хозяйство', 'Охрана природы', 'Рыбоводство', 'Ветеринария',
            'Зоотехния', 'Агрономия', 'Сельскохозяйственная техника', 'Плодоовощеводство',
            'Растениеводство', 'Животноводство', 'Агрохимия', 'Почвознание', 'Мелиорация',
            'Экономика сельского хозяйства', 'Охрана труда', 'Пожарная безопасность',
            'Гражданская оборона', 'Военная подготовка', 'История военного искусства',
            'Тактика', 'Стратегия', 'Военная топография', 'Связь и управление',
            'Военная психология', 'Криптография', 'Теория информации', 'Математическое моделирование',
            'Численные методы', 'Искусственный интеллект', 'Машинное обучение', 'Большие данные',
            'Обработка изображений', 'Компьютерная графика', 'Веб-разработка',
            'Мобильная разработка', 'Базы данных', 'Сетевые технологии', 'Системное администрирование',
            'Тестирование программного обеспечения', 'Разработка игр', 'Когнитивные технологии',
            'Нейронные сети', 'Квантовые вычисления', 'Стандартизация', 'Метрология',
            'Сертификация', 'Управление качеством', 'Экономика качества', 'Инновационный менеджмент',
            'Управление рисками', 'Корпоративное управление', 'Стратегический менеджмент',
            'Экономика предприятия', 'Производственный менеджмент', 'Техническая механика',
            'Сопротивление материалов', 'Детали машин', 'Гидравлика', 'Пневматика',
            'Технология сварки', 'Обработка металлов давлением', 'Литейное производство',
            'Технология пластмасс', 'Композиционные материалы', 'Технология керамики',
            'Электротехнология', 'Техническая термодинамика', 'Холодильная техника',
            'Вентиляция и кондиционирование', 'Отопление', 'Водоснабжение и водоотведение',
            'Экологическая безопасность', 'Утилизация отходов', 'Очистка воды',
            'Воздухоочистка', 'Экологический мониторинг', 'Радиоэкология', 'Гендерные исследования',
            'История науки', 'Науковедение', 'Философия науки', 'Социология науки',
            'Экономика знаний', 'Интеллектуальная собственность', 'Патентоведение',
            'Международное право', 'Конституционное право', 'Трудовое право',
            'Финансовое право', 'Экологическое право', 'Земельное право', 'Жилищное право',
            'Семейное право', 'Медицинское право', 'Арбитражный процесс', 'Гражданский процесс',
            'Уголовный процесс', 'Криминалистика', 'Криминология', 'Пенитенциарная педагогика',
            'Исполнительное производство', 'Нотариат', 'Адвокатура', 'Прокурорский надзор',
            'Судебная экспертиза', 'Международная экономика', 'Внешнеэкономическая деятельность',
            'Таможенное дело', 'Экспорт и импорт', 'Мировая экономика', 'Экономическая безопасность',
            'Государственное управление', 'Муниципальное управление', 'Политическая география',
            'Политическая история', 'Политическая философия', 'Политическая психология',
            'Политическая коммуникация', 'Избирательные технологии', 'Геополитика',
            'Международная безопасность', 'Дипломатия', 'История дипломатии',
            'Региональная политика', 'Сравнительная политология', 'Теория государства и права',
            'История права', 'Римское право', 'Философия права', 'Социология права',
            'Юридическая психология', 'Юридическая этика', 'Документоведение',
            'Архивоведение', 'Делопроизводство', 'Информационное право', 'Киберправо',
            'Авторское право', 'Право интеллектуальной собственности', 'Медицинская этика',
            'Биоэтика', 'Этика бизнеса', 'Корпоративная этика', 'Этика технологий',
            'Философия техники', 'История техники', 'Техническая эстетика',
            'Эргономика', 'Промышленная экология', 'Экономика природопользования',
            'Устойчивое развитие', 'Глобалистика', 'Футурология', 'Социальная экология',
            'Культурная антропология', 'Этнография', 'Этнология', 'Археология',
            'Палеонтология', 'Музееведение', 'Историография', 'Источниковедение',
            'Генеалогия', 'Геральдика', 'Нумизматика', 'Фалеристика', 'Бонистика',
            'Сфрагистика', 'История религии', 'Теология', 'Сектоведение',
            'Мифология', 'Семиотика', 'Герменевтика', 'Феноменология', 'Экзистенциализм',
            'Структурализм', 'Постмодернизм', 'Деконструкция', 'Нарратология',
            'Когнитология', 'Психолингвистика', 'Нейролингвистика', 'Социолингвистика',
            'Этнолингвистика', 'Компьютерная лингвистика', 'Корпусная лингвистика',
            'Прикладная лингвистика', 'Математическая лингвистика', 'История философии',
            'Онтология', 'Гносеология', 'Аксиология', 'Метафизика', 'Диалектика',
            'Философия сознания', 'Философия религии', 'Философия культуры',
            'Философия истории', 'Философия политики', 'Философия экономики',
            'Философия образования', 'Философия математики', 'Философия физики',
            'Философия биологии', 'Философия химии', 'Философия медицины',
            'Философия права', 'Философия языка', 'Философия искусства',
            'Философия музыки', 'Философия кино', 'Философия архитектуры',
            'Философия дизайна', 'Философия моды', 'Философия спорта',
            'Философия войны', 'Философия мира', 'Философия природы',
            'Философия человека', 'Философия общества', 'Философия техники',
            'Философия информации', 'Философия систем', 'Философия хаоса',
            'Философия времени', 'Философия пространства', 'Философия движения',
            'Философия жизни', 'Философия смерти', 'Философия свободы',
            'Философия ответственности', 'Философия справедливости', 'Философия счастья',
            'Философия любви', 'Философия дружбы', 'Философия семьи',
            'Философия гендера', 'Философия идентичности', 'Философия власти',
            'Философия конфликта', 'Философия игры', 'Философия труда',
            'Философия творчества', 'Философия воображения', 'Философия памяти',
            'Философия будущего', 'Философия утопии', 'Философия антиутопии',
            'Философия глобализации', 'Философия постчеловечества', 'Философия трансгуманизма'
        ];
    }

    private static function generateCode($faker): string
    {
        $prefixes = ['МДК', 'ПП', 'УП'];
        $prefix = $faker->randomElement($prefixes);
        $num1 = sprintf("%02d", $faker->numberBetween(1, 99));
        $num2 = sprintf("%02d", $faker->numberBetween(1, 99));
        return "$prefix.$num1.$num2";
    }

    private static function generateDynamicDiscipline($faker): string
    {
        $prefixes = ['Основы', 'Введение в', 'Теория', 'Практика', 'Технология', 'Методы', 'Анализ'];
        $subjects = ['программирования', 'управления', 'экономики', 'дизайна', 'математики', 'физики',
            'химии', 'биологии', 'психологии', 'социологии', 'инженерии', 'медицины',
            'искусства', 'музыки', 'строительства', 'маркетинга', 'педагогики', 'лингвистики'];
        $suffixes = ['', 'и моделирование', 'в современном мире', 'и инновации', 'в промышленности',
            'и управление', 'в образовании', 'и проектирование'];

        return $faker->randomElement($prefixes) . ' ' .
            $faker->randomElement($subjects) . ' ' .
            $faker->randomElement($suffixes);
    }

    /**
     * Возвращает тестовые данные для отчета.
     *
     * @param int $disciplineCount Количество дисциплин (по умолчанию 30)
     * @param int $yearCount Количество учебных лет (по умолчанию 5)
     * @param float $codeAdditionProbability Вероятность добавления кода (от 0 до 1, по умолчанию 0.5)
     * @param bool $useDynamicDisciplines Использовать динамическую генерацию дисциплин (по умолчанию false)
     * @return array
     */
    public static function getTestReportData(
        int $disciplineCount = 30,
        int $yearCount = 5,
        float $codeAdditionProbability = 0.5,
        bool $useDynamicDisciplines = false
    ): array {
        $faker = Faker::create('ru_RU');
        $disciplines = [];

        if ($useDynamicDisciplines) {
            for ($i = 0; $i < $disciplineCount; $i++) {
                $discipline = self::generateDynamicDiscipline($faker);
                if ($faker->randomFloat(0, 0, 1) < $codeAdditionProbability) {
                    $discipline = self::generateCode($faker) . ' ' . $discipline;
                }
                $disciplines[] = $discipline;
            }
        } else {
            $disciplineList = self::getDisciplineList();
            if ($disciplineCount > count($disciplineList)) {
                $disciplineCount = count($disciplineList);
            }
            $selectedDisciplines = $faker->randomElements($disciplineList, $disciplineCount);

            foreach ($selectedDisciplines as $discipline) {
                if ($faker->randomFloat(0, 0, 1) < $codeAdditionProbability) {
                    $discipline = self::generateCode($faker) . ' ' . $discipline;
                }
                $disciplines[] = $discipline;
            }
        }

        $years = [];
        $startYear = 2018;

        for ($i = 0; $i < $yearCount; $i++) {
            $years[] = sprintf('%d-%d', $startYear + $i, $startYear + $i + 1);
        }

        $overallResults = [];
        foreach ($disciplines as $discipline) {
            $overallResults[] = [
                'discipline' => $discipline,
                'avgQuality' => $faker->randomFloat(1, 30, 95),
                'avgAverageScore' => $faker->randomFloat(1, 2.5, 5.0),
            ];
        }

        $qualityTable = [];
        foreach ($disciplines as $discipline) {
            $row = ['discipline' => $discipline];
            foreach ($years as $year) {
                $row[$year] = $faker->boolean(80) ? $faker->randomFloat(1, 30, 95) : null;
            }
            $qualityTable[] = $row;
        }

        $averageScoreTable = [];
        foreach ($disciplines as $discipline) {
            $row = ['discipline' => $discipline];
            foreach ($years as $year) {
                $row[$year] = $faker->boolean(80) ? $faker->randomFloat(1, 2.5, 5.0) : null;
            }
            $averageScoreTable[] = $row;
        }

        return [
            'data' => [
                'overallResults' => $overallResults,
                'finalResults' => [
                    'qualityTable' => $qualityTable,
                    'averageScoreTable' => $averageScoreTable,
                ],
            ],
            'user' => [
                'last_name' => $faker->lastName,
                'name' => $faker->firstName,
                'surname' => $faker->middleName,
            ],
        ];
    }

    /**
     * Возвращает тестовый заголовок отчета.
     *
     * @return string
     */
    public static function getTestReportTitle(): string
    {
        return 'Test Report from ' . now()->format('d.m.Y H:i');
    }
}
